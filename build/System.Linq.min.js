var __extends=this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);n.prototype=e.prototype,t.prototype=new n},System;!function(t){var e;!function(e){"use strict";function n(e){return t.DisposableBase.assertIsNotDisposed(e,"Enumerable was disposed.")}function r(t){return isNaN(t)?0/0:t}function o(t,e){if(typeof t===v.Number&&!isNaN(t)&&t!=(0|t))throw new Error("'"+e+"' must be an integer.");return!0}var i=t.Collections,u=i.ArrayUtility,s=i.EnumeratorBase,c=i.Dictionary,a=i.Queue,f=t.using,p=i.Enumerator.from,l=i.Enumerator.forEach,v=t.Types,d=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e.prototype.Greater=function(t,e){return t>e?t:e},e.prototype.Lesser=function(t,e){return e>t?t:e},e}(t.Functions),y=new d,h=0,m=-1,w=1;!function(t){t[t.Break=0]="Break",t[t.Return=1]="Return",t[t.Skip=2]="Skip"}(e.EnumerableAction||(e.EnumerableAction={}));var g=e.EnumerableAction;Object.freeze(g);var E=function(e){function i(t,n){e.call(this,n),this.enumeratorFactory=t}return __extends(i,e),i.fromArray=function(t){return new N(t)},i.from=function(t){if("getEnumerator"in t)return t;if(t instanceof Array||typeof t===v.Object&&"length"in t)return i.fromArray(t);throw new Error("Unsupported enumerable.")},i.toArray=function(t){if(t instanceof Array)return t.slice();if(typeof t===v.Object&&"length"in t&&(t=i.fromArray(t)),t instanceof i)return t.toArray();if("getEnumerator"in t){var e=[];return l(t.getEnumerator(),function(t,n){e[n]=t}),e}throw new Error("Unsupported enumerable.")},i.prototype.getEnumerator=function(){return this.assertIsNotDisposed(),this.enumeratorFactory()},i.prototype._onDispose=function(){e.prototype._onDispose.call(this),this.enumeratorFactory=null},i.choice=function(t){return new i(function(){return new s(null,function(e){return e.yieldReturn(t[Math.random()*t.length|0])})})},i.cycle=function(t){return new i(function(){var e=h;return new s(function(){e=h},function(n){return e>=t.length&&(e=h),n.yieldReturn(t[e++])})})},i.empty=function(){return new i(function(){return new s(null,y.False)})},i.repeat=function(t,e){return void 0===e&&(e=1/0),isNaN(e)||0>=e?i.empty():new i(isFinite(e)&&o(e,"count")?function(){var n=0|e,r=h;return new s(function(){r=h},function(e){return r++<n&&e.yieldReturn(t)})}:function(){return new s(null,function(e){return e.yieldReturn(t)})})},i.repeatWithFinalize=function(t,e){return new i(function(){var n;return new s(function(){n=t()},function(t){return t.yieldReturn(n)},function(){e(n)})})},i.make=function(t){return i.repeat(t,w)},i.range=function(t,e,n){if(void 0===t&&(t=0),void 0===e&&(e=1/0),void 0===n&&(n=1),!isFinite(t))throw new Error("Must have a valid 'start' value.");if(isNaN(e)||0>=e)return i.empty();if(!isFinite(n))throw new Error("Must have a valid 'step' value.");return new i(isFinite(e)&&o(e,"count")?function(){var r,o=0|e,i=h;return new s(function(){i=h,r=t},function(t){var u=i++<o&&t.yieldReturn(r);return u&&e>i&&(r+=n),u})}:function(){var e;return new s(function(){e=t},function(t){var r=e;return e+=n,t.yieldReturn(r)})})},i.rangeDown=function(t,e,n){return void 0===t&&(t=0),void 0===e&&(e=1/0),void 0===n&&(n=1),n=-1*Math.abs(n),i.range(t,e,n)},i.toInfinity=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=1),i.range(t,1/0,e)},i.toNegativeInfinity=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=1),i.rangeDown(t,1/0,e)},i.rangeTo=function(t,e,n){if(void 0===t&&(t=0),void 0===e&&(e=1/0),void 0===n&&(n=1),!isFinite(t))throw new Error("Must have a valid 'start' value.");if(isNaN(e))throw new Error("Must have a valid 'to' value.");if(!isFinite(n))throw new Error("Must have a valid 'step' value.");return n=Math.abs(n),isFinite(e)?new i(function(){var r;return e>t?new s(function(){r=t},function(t){var o=e>=r&&t.yieldReturn(r);return o&&(r+=n),o}):new s(function(){r=t},function(t){var o=r>=e&&t.yieldReturn(r);return o&&(r-=n),o})}):i.range(t,1/0,e>t?+n:-n)},i.matches=function(t,e,n){void 0===n&&(n="");var r=typeof t;if(r!=v.String)throw new Error("Cannot exec RegExp matches of type '"+r+"'.");return e instanceof RegExp&&(n+=e.ignoreCase?"i":"",n+=e.multiline?"m":"",e=e.source),-1===n.indexOf("g")&&(n+="g"),new i(function(){var r;return new s(function(){r=new RegExp(e,n)},function(e){var n=r.exec(t);return null!==n?e.yieldReturn(n):!1})})},i.generate=function(t,e){return void 0===e&&(e=1/0),isNaN(e)||0>=e?i.empty():new i(isFinite(e)&&o(e,"count")?function(){var n=0|e,r=h;return new s(function(){r=h},function(e){var o=r++;return n>o&&e.yieldReturn(t(o))})}:function(){var e=h;return new s(function(){e=h},function(n){return n.yieldReturn(t(e++))})})},i.unfold=function(t,e,n){return void 0===n&&(n=!1),new i(function(){var r,o,i=h;return new s(function(){i=h,r=t,o=!n},function(t){var n=i++;return o?o=!1:r=e(r,n),t.yieldReturn(r)})})},i.defer=function(e){return new i(function(){var n;return new s(function(){n=e().getEnumerator()},function(t){return n.moveNext()&&t.yieldReturn(n.current)},function(){t.dispose(n)})})},i.forEach=function(e,n){t.Collections.Enumerable.forEach(e,n)},i.max=function(t){return t.takeUntil(function(t){return t==+1/0},!0).aggregate(y.Greater)},i.min=function(t){return t.takeUntil(function(t){return t==-1/0},!0).aggregate(y.Lesser)},i.prototype.assertIsNotDisposed=function(t){return void 0===t&&(t="Enumerable was disposed."),e.prototype.assertIsNotDisposed.call(this,t)},i.prototype.forEach=function(t){var e=this;e.assertIsNotDisposed();var n=h;f(e.getEnumerator(),function(r){for(;e.assertIsNotDisposed()&&r.moveNext()&&t(r.current,n++)!==!1;);})},i.prototype.toArray=function(t){var e=[];return t?this.where(t).toArray():(this.forEach(function(t,n){e[n]=t}),e)},i.prototype.asEnumerable=function(){var t=this;return new i(function(){return t.getEnumerator()})},i.prototype.toLookup=function(t,e,n){void 0===e&&(e=y.Identity),void 0===n&&(n=y.Identity);var r=new c(n);return this.forEach(function(n){var o=t(n),i=e(n),u=r.get(o);void 0!==u?u.push(i):r.addByKeyValue(o,[i])}),new k(r)},i.prototype.toMap=function(t,e){var n={};return this.forEach(function(r){n[t(r)]=e(r)}),n},i.prototype.toDictionary=function(t,e,n){void 0===n&&(n=y.Identity);var r=new c(n);return this.forEach(function(n){return r.addByKeyValue(t(n),e(n))}),r},i.prototype.toJoinedString=function(t,e){return void 0===t&&(t=""),void 0===e&&(e=y.Identity),this.select(e).toArray().join(t)},i.prototype.doAction=function(e){var r=this,o=!r.assertIsNotDisposed();return new i(function(){var i,u=h;return new s(function(){n(o),u=h,i=r.getEnumerator()},function(t){for(n(o);i.moveNext();){var r=e(i.current,u++);if(r===!1||r===g)return t.yieldBreak();if(2!==r)return t.yieldReturn(i.current)}return!1},function(){t.dispose(i)})},function(){o=!0})},i.prototype.force=function(t){void 0===t&&(t=g.Break),this.assertIsNotDisposed(),this.doAction(function(){return t})},i.prototype.skip=function(t){var e=this;if(e.assertIsNotDisposed(),!t||isNaN(t)||0>t)return e;if(!isFinite(t))return i.empty();o(t,"count");var n=0|t;return this.doAction(function(t,e){return n>e?g.Skip:g.Return})},i.prototype.skipWhile=function(t){this.assertIsNotDisposed();var e=!0;return this.doAction(function(n,r){return e&&(e=t(n,r)),e?g.Skip:g.Return})},i.prototype.take=function(t){if(!t||isNaN(t)||0>t)return i.empty();var e=this;if(e.assertIsNotDisposed(),!isFinite(t))return e;o(t,"count");var n=0|t;return e.doAction(function(t,e){return n>e})},i.prototype.takeWhile=function(t){return this.assertIsNotDisposed(),this.doAction(function(e,n){return t(e,n)?g.Return:g.Break})},i.prototype.takeUntil=function(t,e){if(this.assertIsNotDisposed(),!e)return this.doAction(function(e,n){return t(e,n)?g.Break:g.Return});var n=!1;return this.doAction(function(e,r){return n?g.Break:(n=t(e,r),g.Return)})},i.prototype.takeExceptLast=function(e){void 0===e&&(e=1);var n=this;if(!e||isNaN(e)||0>=e)return n;if(!isFinite(e))return i.empty();o(e,"count");var r=0|e;return new i(function(){var e,o;return new s(function(){e=n.getEnumerator(),o=new a},function(t){for(;e.moveNext();)if(o.enqueue(e.current),o.count>r)return t.yieldReturn(o.dequeue());return!1},function(){t.dispose(e,o)})})},i.prototype.takeFromLast=function(t){if(!t||isNaN(t)||0>=t)return i.empty();var e=this;return isFinite(t)?(o(t,"count"),e.reverse().take(0|t)):e.reverse()},i.prototype.traverseBreadthFirst=function(e,n){var r=this;return new i(function(){var o,u,c,a=h;return new s(function(){a=h,u=[],c=0,o=r.getEnumerator()},function(t){for(;;){if(o.moveNext())return u[c++]=o.current,t.yieldReturn(n(o.current,a));if(!c)return t.yieldBreak();var r=i.fromArray(u).selectMany(e);if(!r.any())return t.yieldBreak();a++,u=[],c=0,o.dispose(),o=r.getEnumerator()}},function(){t.dispose(o),u.length=0})})},i.prototype.traverseDepthFirst=function(e,n){var r=this;return new i(function(){var o,i,u=[];return new s(function(){o=r.getEnumerator(),i=0},function(t){for(;;){if(o.moveNext()){var r=n(o.current,i);return u[i++]=o,o=e(o.current).getEnumerator(),t.yieldReturn(r)}if(0==i)return!1;o.dispose(),o=u[--i],u.length=i}},function(){try{t.dispose(o)}finally{t.disposeThese(u)}})})},i.prototype.flatten=function(){var e=this;return new i(function(){var n,r=null;return new s(function(){n=e.getEnumerator()},function(t){for(;;){if(null!=r){if(r.moveNext())return t.yieldReturn(r.current);r=null}if(n.moveNext()){var e=n.current;if(e instanceof Array){r.dispose(),r=i.fromArray(e).selectMany(y.Identity).flatten().getEnumerator();continue}return t.yieldReturn(n.current)}return!1}},function(){t.dispose(n,r)})})},i.prototype.pairwise=function(e){var n=this;return new i(function(){var r;return new s(function(){r=n.getEnumerator(),r.moveNext()},function(t){var n=r.current;return r.moveNext()&&t.yieldReturn(e(n,r.current))},function(){t.dispose(r)})})},i.prototype.scan=function(e,n){var r=void 0!==n,o=this;return new i(function(){var i,u,c;return new s(function(){i=o.getEnumerator(),c=!0},function(t){return c?(c=!1,r?t.yieldReturn(u=n):i.moveNext()&&t.yieldReturn(u=i.current)):i.moveNext()?t.yieldReturn(u=e(u,i.current)):!1},function(){t.dispose(i)})})},i.prototype.select=function(e){var r=this,o=!r.assertIsNotDisposed();return e.length<2?new D(r,null,e):new i(function(){var i,u=h;return new s(function(){n(o),u=h,i=r.getEnumerator()},function(t){return n(o),i.moveNext()?t.yieldReturn(e(i.current,u++)):!1},function(){t.dispose(i)})},function(){o=!0})},i.prototype.selectMany=function(e,n){var r=this;return n||(n=function(t,e){return e}),new i(function(){var o,i,u=h;return new s(function(){o=r.getEnumerator(),i=void 0,u=h},function(r){if(void 0===i&&!o.moveNext())return!1;do{if(!i){var s=e(o.current,u++);if(!s)continue;i=t.Collections.Enumerator.from(s)}if(i.moveNext())return r.yieldReturn(n(o.current,i.current));i.dispose(),i=null}while(o.moveNext());return!1},function(){t.dispose(o,i),o=null,i=null})})},i.prototype.choose=function(e){var r=this,o=!r.assertIsNotDisposed();return new i(function(){var i,u=h;return new s(function(){n(o),u=h,i=r.getEnumerator()},function(t){for(n(o);i.moveNext();){var r=e(i.current,u++);if(null!==r&&void 0!==r)return t.yieldReturn(r)}return!1},function(){t.dispose(i)})},function(){o=!0})},i.prototype.where=function(e){var r=this,o=!r.assertIsNotDisposed();return e.length<2?new x(r,e):new i(function(){var i,u=h;return new s(function(){n(o),u=h,i=r.getEnumerator()},function(t){for(n(o);i.moveNext();)if(e(i.current,u++))return t.yieldReturn(i.current);return!1},function(){t.dispose(i)})},function(){o=!0})},i.prototype.ofType=function(t){var e;switch(t){case Number:e=v.Number;break;case String:e=v.String;break;case Boolean:e=v.Boolean;break;case Function:e=v.Function;break;default:e=null}return this.where(null===e?function(e){return e instanceof t}:function(t){return typeof t===e})},i.prototype.except=function(e,r){var o=this,u=!o.assertIsNotDisposed();return new i(function(){var a,f;return new s(function(){n(u),a=o.getEnumerator(),f=new c(r),e&&i.forEach(e,function(t){return f.addByKeyValue(t,!0)})},function(t){for(n(u);a.moveNext();){var e=a.current;if(!f.containsKey(e))return f.addByKeyValue(e,!0),t.yieldReturn(e)}return!1},function(){t.dispose(a),f.clear()})},function(){u=!0})},i.prototype.distinct=function(t){return this.except(null,t)},i.prototype.distinctUntilChanged=function(e){var r=this,o=!r.assertIsNotDisposed();return new i(function(){var i,u,c=!0;return new s(function(){n(o),i=r.getEnumerator()},function(t){for(n(o);i.moveNext();){var r=e(i.current);if(c)c=!1;else if(u===r)continue;return u=r,t.yieldReturn(i.current)}return!1},function(){t.dispose(i)})},function(){o=!0})},i.prototype.reverse=function(){var t=this,e=!t.assertIsNotDisposed();return new i(function(){var r,o=h;return new s(function(){n(e),r=t.toArray(),o=0|r.length},function(t){return o>h&&t.yieldReturn(r[--o])},function(){r.length=0})},function(){e=!0})},i.prototype.shuffle=function(){var t=this,e=!t.assertIsNotDisposed();return new i(function(){var r,o,i;return new s(function(){n(e),r=t.toArray(),o=i=r.length},function(t){if(!i)return t.yieldBreak();var e=Math.random()*i|0,n=r[e],o=r[--i];return r[e]=o,r[i]=null,i%32==0&&(r.length=i),t.yieldReturn(n)},function(){r.length=0})},function(){e=!0})},i.prototype.count=function(t){var e=this;e.assertIsNotDisposed();var n=h;return e.forEach(t?function(e,r){t(e,r)&&++n}:function(){++n}),n},i.prototype.all=function(t){var e=!0;return this.forEach(function(n){return t(n)?void 0:(e=!1,!1)}),e},i.prototype.every=function(t){return this.all(t)},i.prototype.any=function(t){var e=!1;return this.forEach(t?function(n){return e=t(n),!e}:function(){return e=!0,!1}),e},i.prototype.some=function(t){return this.any(t)},i.prototype.isEmpty=function(){return!this.any()},i.prototype.contains=function(t,e){return this.any(e?function(n){return e(n)===e(t)}:function(e){return e===t})},i.prototype.indexOf=function(e,n){var r=m;return this.forEach(n?function(o,i){return t.areEqual(n(o),n(e),!0)?(r=i,!1):void 0}:function(n,o){return t.areEqual(n,e,!0)?(r=o,!1):void 0}),r},i.prototype.lastIndexOf=function(e,n){var r=m;return this.forEach(n?function(o,i){t.areEqual(n(o),n(e),!0)&&(r=i)}:function(n,o){t.areEqual(n,e,!0)&&(r=o)}),r},i.prototype.defaultIfEmpty=function(e){void 0===e&&(e=null);var r=this,o=!r.assertIsNotDisposed();return new i(function(){var i,u;return new s(function(){u=!0,n(o),i=r.getEnumerator()},function(t){return n(o),i.moveNext()?(u=!1,t.yieldReturn(i.current)):u?(u=!1,t.yieldReturn(e)):!1},function(){t.dispose(i)})})},i.prototype.zip=function(e,n){var r=this;return new i(function(){var o,i,u=h;return new s(function(){u=h,o=r.getEnumerator(),i=p(e)},function(t){return o.moveNext()&&i.moveNext()&&t.yieldReturn(n(o.current,i.current,u++))},function(){t.dispose(o,i)})})},i.prototype.zipMultiple=function(e,n){var r=this;return e.length?new i(function(){var o,i,u,c=h;return new s(function(){o=new a(e),c=h,i=r.getEnumerator(),u=null},function(t){if(i.moveNext())for(;;){for(;!u;){var e;if(!o.count)return t.yieldBreak();var e=o.dequeue();e&&(u=p(e))}if(u.moveNext())return t.yieldReturn(n(i.current,u.current,c++));u.dispose(),u=null}return t.yieldBreak()},function(){t.dispose(i,o)})}):i.empty()},i.prototype.join=function(e,n,r,o,u){void 0===u&&(u=y.Identity);var c=this;return new i(function(){var a,f,p=null,l=h;return new s(function(){a=c.getEnumerator(),f=i.from(e).toLookup(r,y.Identity,u)},function(t){for(;;){if(null!=p){var e=p[l++];if(void 0!==e)return t.yieldReturn(o(a.current,e));e=null,l=h}if(!a.moveNext())return t.yieldBreak();var r=n(a.current);p=f.get(r)}},function(){t.dispose(a)})})},i.prototype.groupJoin=function(e,n,r,o,u){void 0===u&&(u=y.Identity);var c=this;return new i(function(){var a,f=null;return new s(function(){a=c.getEnumerator(),f=i.from(e).toLookup(r,y.Identity,u)},function(t){return a.moveNext()&&t.yieldReturn(o(a.current,f.get(n(a.current))))},function(){t.dispose(a)})})},i.prototype.concatWith=function(e){var n=this;return new i(function(){var r,o;return new s(function(){r=n.getEnumerator()},function(t){if(null!=r){if(r.moveNext())return t.yieldReturn(r.current);o=p(e),r.dispose(),r=null}return o.moveNext()?t.yieldReturn(o.current):!1},function(){t.dispose(r,o)})})},i.prototype.merge=function(e){var n=this;return e.length?1==e.length?n.concatWith(e[0]):new i(function(){var r,o;return new s(function(){r=n.getEnumerator(),o=new a(e)},function(t){for(;;){for(;!r&&o.count;)r=p(o.dequeue());if(r&&r.moveNext())return t.yieldReturn(r.current);{if(!r)return t.yieldBreak();r.dispose(),r=null}}},function(){t.dispose(r,o)})}):n},i.prototype.concat=function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];var n=this;return 0==t.length?n:1==t.length?n.concatWith(t[0]):n.merge(t)},i.prototype.insertAt=function(e,n){if(isNaN(e)||0>e||!isFinite(e))throw new Error("'index' is invalid or out of bounds.");o(e,"index");var r=0|e,u=this;return u.assertIsNotDisposed(),new i(function(){var e,o,i=h,c=!1;return new s(function(){i=h,e=u.getEnumerator(),o=p(n),c=!1},function(t){return i==r&&(c=!0,o.moveNext())?t.yieldReturn(o.current):e.moveNext()?(i++,t.yieldReturn(e.current)):!c&&o.moveNext()&&t.yieldReturn(o.current)},function(){t.dispose(e,o)})})},i.prototype.alternateMultiple=function(e){var n=this;return new i(function(){var r,o,u,c;return new s(function(){c=new t.Collections.ArrayEnumerator(i.toArray(e)),u=n.getEnumerator();var s=u.moveNext();o=s?g.Return:g.Break,s&&(r=u.current)},function(t){switch(o){case g.Break:return t.yieldBreak();case g.Skip:if(c.moveNext())return t.yieldReturn(c.current);c.reset(),o=g.Return}var e=r,n=u.moveNext();return o=n?g.Skip:g.Break,n&&(r=u.current),t.yieldReturn(e)},function(){t.dispose(u,c)})})},i.prototype.alternateSingle=function(t){return this.alternateMultiple(i.make(t))},i.prototype.alternate=function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];return this.alternateMultiple(t)},i.prototype.intersect=function(e,n){var r=this;return new i(function(){var o,u,a;return new s(function(){o=r.getEnumerator(),u=new c(n),a=new c(n),i.from(e).forEach(function(t){u.addByKeyValue(t,!0)})},function(t){for(;o.moveNext();){var e=o.current;if(!a.containsKey(e)&&u.containsKey(e))return a.addByKeyValue(e,!0),t.yieldReturn(e)}return t.yieldBreak()},function(){t.dispose(o)})})},i.prototype.sequenceEqual=function(e,n){return void 0===n&&(n=t.areEqual),f(this.getEnumerator(),function(t){return f(i.from(e).getEnumerator(),function(e){for(;t.moveNext();)if(!e.moveNext()||!n(t.current,e.current))return!1;return!e.moveNext()})})},i.prototype.union=function(e,n){void 0===n&&(n=y.Identity);var r=this;return new i(function(){var o,u,a;return new s(function(){o=r.getEnumerator(),a=new c(n)},function(t){var n;if(void 0===u){for(;o.moveNext();)if(n=o.current,!a.containsKey(n))return a.addByKeyValue(n,null),t.yieldReturn(n);u=i.from(e).getEnumerator()}for(;u.moveNext();)if(n=u.current,!a.containsKey(n))return a.addByKeyValue(n,null),t.yieldReturn(n);return!1},function(){t.dispose(o,u)})})},i.prototype.orderBy=function(t){return void 0===t&&(t=y.Identity),new R(this,t,!1)},i.prototype.orderByDescending=function(t){return void 0===t&&(t=y.Identity),new R(this,t,!0)},i.prototype.groupBy=function(t,e,n){void 0===e&&(e=y.Identity);var r=this;return new i(function(){return r.toLookup(t,e,n).getEnumerator()})},i.prototype.partitionBy=function(e,n,r,o){void 0===n&&(n=y.Identity),void 0===r&&(r=function(t,e){return new _(t,e)}),void 0===o&&(o=y.Identity);var u=this;return new i(function(){var i,c,a,f,p;return new s(function(){i=u.getEnumerator(),i.moveNext()?(c=e(i.current),a=o(c),f=[n(i.current)],p=1):f=null},function(t){if(!f)return t.yieldBreak();for(var u,s;(u=i.moveNext())&&(s=i.current,a===o(e(s)));)f[p++]=n(s);var l=r(c,f);return u?(s=i.current,c=e(s),a=o(c),f=[n(s)],p=1):f=null,t.yieldReturn(l)},function(){t.dispose(i),f=null})})},i.prototype.buffer=function(e){if(1>e||!isFinite(e))throw new Error("Invalid buffer size.");o(e,"size");var n,r=this;return new i(function(){var o;return new s(function(){o=r.getEnumerator()},function(t){var r=u.initialize(e);for(n=0;e>n&&o.moveNext;)r[n++]=o.current;return r.length=n,n&&t.yieldReturn(r)},function(){t.dispose(o)})})},i.prototype.aggregate=function(t,e){return this.scan(t,e).lastOrDefault()},i.prototype.average=function(t){void 0===t&&(t=r);var e=0,n=0,o=0;return this.forEach(function(r){var i=t(r);return isNaN(i)?(e=0/0,!1):(isFinite(i)?e+=i:n+=i>0?1:-1,void++o)}),n?1/0*n:isNaN(e)||!o?0/0:e/o},i.prototype.max=function(){return this.aggregate(y.Greater)},i.prototype.min=function(){return this.aggregate(y.Lesser)},i.prototype.maxBy=function(t){return void 0===t&&(t=y.Identity),this.aggregate(function(e,n){return t(e)>t(n)?e:n})},i.prototype.minBy=function(t){return void 0===t&&(t=y.Identity),this.aggregate(function(e,n){return t(e)<t(n)?e:n})},i.prototype.sum=function(t){void 0===t&&(t=r);var e=0,n=0;return this.forEach(function(r){var o=t(r);return isNaN(o)?(e=0/0,!1):void(isFinite(o)?e+=o:n+=o>0?1:-1)}),isNaN(e)?0/0:n?1/0*n:e},i.prototype.product=function(t){void 0===t&&(t=r);var e=1,n=!1;return this.forEach(function(r){n=!0;var o=t(r);return isNaN(o)?(e=0/0,!1):0==o?(e=0,!1):void(e*=o)}),n&&isNaN(e)?0/0:e},i.prototype.elementAt=function(t){if(isNaN(t)||0>t||!isFinite(t))throw new Error("'index' is invalid or out of bounds.");o(t,"index");var e=0|t,n=this;n.assertIsNotDisposed();var r,i=!1;if(n.forEach(function(t,n){return n==e?(r=t,i=!0,!1):void 0}),!i)throw new Error("index is less than 0 or greater than or equal to the number of elements in source.");return r},i.prototype.elementAtOrDefault=function(t,e){if(void 0===e&&(e=null),isNaN(t)||0>t||!isFinite(t))throw new Error("'index' is invalid or out of bounds.");o(t,"index");var n=0|t,r=this;r.assertIsNotDisposed();var i,u=!1;return r.forEach(function(t,e){return e==n?(i=t,u=!0,!1):void 0}),u?i:e},i.prototype.first=function(){var t=this;t.assertIsNotDisposed();var e,n=!1;if(t.forEach(function(t){return e=t,n=!0,!1}),!n)throw new Error("first:No element satisfies the condition.");return e},i.prototype.firstOrDefault=function(t){void 0===t&&(t=null);var e=this;e.assertIsNotDisposed();var n,r=!1;return e.forEach(function(t){return n=t,r=!0,!1}),r?n:t},i.prototype.last=function(){var t=this;t.assertIsNotDisposed();var e,n=!1;if(t.forEach(function(t){n=!0,e=t}),!n)throw new Error("last:No element satisfies the condition.");return e},i.prototype.lastOrDefault=function(t){void 0===t&&(t=null);var e=this;e.assertIsNotDisposed();var n,r=!1;return e.forEach(function(t){r=!0,n=t}),r?n:t},i.prototype.single=function(){var t=this;t.assertIsNotDisposed();var e,n=!1;if(t.forEach(function(t){if(n)throw new Error("single:sequence contains more than one element.");n=!0,e=t}),!n)throw new Error("single:No element satisfies the condition.");return e},i.prototype.singleOrDefault=function(t){void 0===t&&(t=null);var e=this;e.assertIsNotDisposed();var n,r=!1;return e.forEach(function(t){if(r)throw new Error("single:sequence contains more than one element.");r=!0,n=t}),r?n:t},i.prototype.share=function(){var e=this;e.assertIsNotDisposed();var n;return new i(function(){return new s(function(){n||(n=e.getEnumerator())},function(t){return n.moveNext()&&t.yieldReturn(n.current)})},function(){t.dispose(n)})},i.prototype.memoize=function(){var e,r,o=this,u=!o.assertIsNotDisposed();return new i(function(){var t=h;return new s(function(){n(u),r||(r=o.getEnumerator()),e||(e=[]),t=h},function(o){n(u);var i=t++;return i>=e.length?r.moveNext()?o.yieldReturn(e[i]=r.current):!1:o.yieldReturn(e[i])})},function(){u=!0,e&&(e.length=0),e=null,t.dispose(r),r=null})},i.prototype.catchError=function(e){var r=this,o=!r.assertIsNotDisposed();return new i(function(){var i;return new s(function(){try{n(o),i=r.getEnumerator()}catch(t){}},function(t){try{if(n(o),i.moveNext())return t.yieldReturn(i.current)}catch(r){e(r)}return!1},function(){t.dispose(i)})})},i.prototype.finallyAction=function(e){var r=this,o=!r.assertIsNotDisposed();return new i(function(){var i;return new s(function(){n(o),i=r.getEnumerator()},function(t){return n(o),i.moveNext()?t.yieldReturn(i.current):!1},function(){try{t.dispose(i)}finally{e()}})})},i}(t.DisposableBase);e.Enumerable=E;var N=function(e){function n(n){var r=this;r._source=n,e.call(this,function(){return r.assertIsNotDisposed(),new t.Collections.ArrayEnumerator(function(){return r.assertIsNotDisposed("The underlying ArrayEnumerable was disposed."),r._source})})}return __extends(n,e),n.prototype._onDispose=function(){e.prototype._onDispose.call(this),this._source=null},Object.defineProperty(n.prototype,"source",{get:function(){return this._source},enumerable:!0,configurable:!0}),n.prototype.toArray=function(){var t=this.source;if(!t)return[];if(t instanceof Array)return t.slice();for(var e=t.length,n=new Array(e),r=h;e>r;++r)n[r]=t[r];return n},n.prototype.asEnumerable=function(){return new n(this._source)},n.prototype.forEach=function(t){var e=this;e.assertIsNotDisposed();var n=e._source;if(n)for(var r=h;r<n.length&&t(n[r],r)!==!1;++r);},n.prototype.any=function(t){var n=this;n.assertIsNotDisposed();var r=n._source,o=r?r.length:0;return o&&(!t||e.prototype.any.call(this,t))},n.prototype.count=function(t){var n=this;n.assertIsNotDisposed();var r=n._source,o=r?r.length:0;return o&&(t?e.prototype.count.call(this,t):o)},n.prototype.elementAt=function(t){var n=this;n.assertIsNotDisposed();var r=n._source;return t<r.length&&t>=0?r[t]:e.prototype.elementAt.call(this,t)},n.prototype.elementAtOrDefault=function(t,e){void 0===e&&(e=null);var n=this;n.assertIsNotDisposed();var r=n._source;return t<r.length&&t>=0?r[t]:e},n.prototype.first=function(){var t=this;t.assertIsNotDisposed();var n=t._source;return n&&n.length?n[0]:e.prototype.first.call(this)},n.prototype.firstOrDefault=function(t){void 0===t&&(t=null);var e=this;e.assertIsNotDisposed();var n=e._source;return n&&n.length?n[0]:t},n.prototype.last=function(){var t=this;t.assertIsNotDisposed();var n=t._source,r=n.length;return r?n[r-1]:e.prototype.last.call(this)},n.prototype.lastOrDefault=function(t){void 0===t&&(t=null);var e=this;e.assertIsNotDisposed();var n=e._source,r=n.length;return r?n[r-1]:t},n.prototype.skip=function(e){var n=this;return!e||0>e?n.asEnumerable():new E(function(){return new t.Collections.ArrayEnumerator(function(){return n._source},e)})},n.prototype.takeExceptLast=function(t){void 0===t&&(t=1);var e=this,n=e._source?e._source.length:0;return e.take(n-t)},n.prototype.takeFromLast=function(t){if(!t||0>t)return E.empty();var e=this,n=e._source?e._source.length:0;return e.skip(n-t)},n.prototype.reverse=function(){var e=this;return new E(function(){return new t.Collections.ArrayEnumerator(function(){return e._source},e._source?e._source.length-1:0,-1)})},n.prototype.memoize=function(){return new n(this._source)},n.prototype.sequenceEqual=function(r,o){return void 0===o&&(o=t.areEqual),r instanceof Array?u.areEqual(this.source,r,!0,o):r instanceof n?r.sequenceEqual(this.source,o):e.prototype.sequenceEqual.call(this,r,o)},n.prototype.toJoinedString=function(t,n){void 0===t&&(t=""),void 0===n&&(n=y.Identity);var r=this._source;return!n&&r instanceof Array?r.join(t):e.prototype.toJoinedString.call(this,t,n)},n}(E);e.ArrayEnumerable=N;var x=function(e){function n(t,n){e.call(this,null),this.prevSource=t,this.prevPredicate=n}return __extends(n,e),n.prototype.where=function(t){if(t.length>1)return e.prototype.where.call(this,t);var r=this.prevPredicate,o=function(e){return r(e)&&t(e)};return new n(this.prevSource,o)},n.prototype.select=function(t){return t.length>1?e.prototype.select.call(this,t):new D(this.prevSource,this.prevPredicate,t)},n.prototype.getEnumerator=function(){var e,n=this.prevPredicate,r=this.prevSource;return new t.Collections.EnumeratorBase(function(){e=r.getEnumerator()},function(t){for(;e.moveNext();)if(n(e.current))return t.yieldReturn(e.current);return!1},function(){t.dispose(e)})},n.prototype._onDispose=function(){e.prototype._onDispose.call(this),this.prevPredicate=null,this.prevSource=null},n}(E);e.WhereEnumerable=x;var D=function(e){function n(t,n,r){e.call(this,null),this.prevSource=t,this.prevPredicate=n,this.prevSelector=r}return __extends(n,e),n.prototype.where=function(t){return t.length>1?e.prototype.where.call(this,t):new x(this,t)},n.prototype.select=function(t){if(t.length>1)return e.prototype.select.call(this,t);var r=this,o=r.prevSelector,i=function(e){return t(o(e))};return new n(r.prevSource,r.prevPredicate,i)},n.prototype.getEnumerator=function(){var e,n=this,r=n.prevPredicate,o=n.prevSource,i=n.prevSelector;return new s(function(){e=o.getEnumerator()},function(t){for(;e.moveNext();){var n=e.current;if(null==r||r(n))return t.yieldReturn(i(n))}return!1},function(){t.dispose(e)})},n.prototype._onDispose=function(){var t=this;e.prototype._onDispose.call(this),t.prevPredicate=null,t.prevSource=null,t.prevSelector=null},n}(E);e.WhereSelectEnumerable=D;var R=function(e){function n(t,n,r,o){e.call(this,null),this.source=t,this.keySelector=n,this.descending=r,this.parent=o}return __extends(n,e),n.prototype.createOrderedEnumerable=function(t,e){return new n(this.source,t,e,this)},n.prototype.thenBy=function(t){return this.createOrderedEnumerable(t,!1)},n.prototype.thenByDescending=function(t){return this.createOrderedEnumerable(t,!0)},n.prototype.getEnumerator=function(){var e,n,r=this,o=h;return new t.Collections.EnumeratorBase(function(){o=h,e=[],n=[],E.forEach(r.source,function(t,r){e[r]=t,n[r]=r});var t=I.create(r);t.generateKeys(e),n.sort(function(e,n){return t.compare(e,n)})},function(t){return o<n.length?t.yieldReturn(e[n[o++]]):!1},function(){e&&(e.length=0),e=null,n&&(n.length=0),n=null})},n.prototype._onDispose=function(){e.prototype._onDispose.call(this),this.source=null,this.keySelector=null,this.descending=null,this.parent=null},n}(E);e.OrderedEnumerable=R;var I=function(){function e(t,e,n){this.keySelector=t,this.descending=e,this.child=n,this.keys=null}return e.create=function(t,n){void 0===n&&(n=null);var r=new e(t.keySelector,t.descending,n);return t.parent?e.create(t.parent,r):r},e.prototype.generateKeys=function(t){for(var e=this,n=0|t.length,r=e.keySelector,o=new Array(n),i=h;n>i;++i)o[i]=r(t[i]);e.keys=o,e.child&&e.child.generateKeys(t)},e.prototype.compare=function(e,n){var r=this,o=r.keys,i=t.compare(o[e],o[n]);if(0==i){var u=r.child;return u?u.compare(e,n):t.compare(e,n)}return r.descending?-i:i},e}(),k=function(){function e(t){this._dictionary=t}return Object.defineProperty(e.prototype,"count",{get:function(){return this._dictionary.count},enumerable:!0,configurable:!0}),e.prototype.get=function(t){return this._dictionary.get(t)},e.prototype.contains=function(t){return this._dictionary.containsKey(t)},e.prototype.getEnumerator=function(){var e,n=this;return new t.Collections.EnumeratorBase(function(){e=n._dictionary.getEnumerator()},function(t){if(!e.moveNext())return!1;var n=e.current;return t.yieldReturn(new _(n.key,n.value))},function(){t.dispose(e)})},e}();e.Lookup=k;var _=function(t){function e(e,n){t.call(this,n),this._groupKey=e}return __extends(e,t),Object.defineProperty(e.prototype,"key",{get:function(){return this._groupKey},enumerable:!0,configurable:!0}),e}(N);e.Grouping=_}(e=t.Linq||(t.Linq={}))}(System||(System={}));
//# sourceMappingURL=../build/System.Linq.min.js.map